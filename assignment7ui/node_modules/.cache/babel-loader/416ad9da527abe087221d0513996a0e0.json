{"ast":null,"code":"var fs = require('fs');\n\nvar path = require('path');\n\nvar relativePath = require('cached-path-relative');\n\nvar browserResolve = require('browser-resolve');\n\nvar nodeResolve = require('resolve');\n\nvar detective = require('detective');\n\nvar through = require('through2');\n\nvar concat = require('concat-stream');\n\nvar parents = require('parents');\n\nvar combine = require('stream-combiner2');\n\nvar duplexer = require('duplexer2');\n\nvar xtend = require('xtend');\n\nvar defined = require('defined');\n\nvar inherits = require('inherits');\n\nvar Transform = require('readable-stream').Transform;\n\nmodule.exports = Deps;\ninherits(Deps, Transform);\n\nfunction Deps(opts) {\n  var self = this;\n  if (!(this instanceof Deps)) return new Deps(opts);\n  Transform.call(this, {\n    objectMode: true\n  });\n  if (!opts) opts = {};\n  this.basedir = opts.basedir || process.cwd();\n\n  this.persistentCache = opts.persistentCache || function (file, id, pkg, fallback, cb) {\n    process.nextTick(function () {\n      fallback(null, cb);\n    });\n  };\n\n  this.cache = opts.cache;\n  this.fileCache = opts.fileCache;\n  this.pkgCache = opts.packageCache || {};\n  this.pkgFileCache = {};\n  this.pkgFileCachePending = {};\n  this._emittedPkg = {};\n  this._transformDeps = {};\n  this.visited = {};\n  this.walking = {};\n  this.entries = [];\n  this._input = [];\n  this.paths = opts.paths || process.env.NODE_PATH || '';\n\n  if (typeof this.paths === 'string') {\n    var delimiter = path.delimiter || (process.platform === 'win32' ? ';' : ':');\n    this.paths = this.paths.split(delimiter);\n  }\n\n  this.paths = this.paths.filter(Boolean).map(function (p) {\n    return path.resolve(self.basedir, p);\n  });\n  this.transforms = [].concat(opts.transform).filter(Boolean);\n  this.globalTransforms = [].concat(opts.globalTransform).filter(Boolean);\n  this.resolver = opts.resolve || browserResolve;\n  this.detective = opts.detect || detective;\n  this.options = xtend(opts);\n  if (!this.options.modules) this.options.modules = {}; // If the caller passes options.expose, store resolved pathnames for exposed\n  // modules in it. If not, set it anyway so it's defined later.\n\n  if (!this.options.expose) this.options.expose = {};\n  this.pending = 0;\n  this.inputPending = 0;\n  var topfile = path.join(this.basedir, '__fake.js');\n  this.top = {\n    id: topfile,\n    filename: topfile,\n    paths: this.paths,\n    basedir: this.basedir\n  };\n}\n\nDeps.prototype._isTopLevel = function (file) {\n  var isTopLevel = this.entries.some(function (main) {\n    var m = relativePath(path.dirname(main), file);\n    return m.split(/[\\\\\\/]/).indexOf('node_modules') < 0;\n  });\n\n  if (!isTopLevel) {\n    var m = relativePath(this.basedir, file);\n    isTopLevel = m.split(/[\\\\\\/]/).indexOf('node_modules') < 0;\n  }\n\n  return isTopLevel;\n};\n\nDeps.prototype._transform = function (row, enc, next) {\n  var self = this;\n\n  if (typeof row === 'string') {\n    row = {\n      file: row\n    };\n  }\n\n  if (row.transform && row.global) {\n    this.globalTransforms.push([row.transform, row.options]);\n    return next();\n  } else if (row.transform) {\n    this.transforms.push([row.transform, row.options]);\n    return next();\n  }\n\n  self.pending++;\n  var basedir = defined(row.basedir, self.basedir);\n\n  if (row.entry !== false) {\n    self.entries.push(path.resolve(basedir, row.file || row.id));\n  }\n\n  self.lookupPackage(row.file, function (err, pkg) {\n    if (err && self.options.ignoreMissing) {\n      self.emit('missing', row.file, self.top);\n      self.pending--;\n      return next();\n    }\n\n    if (err) return self.emit('error', err);\n    self.pending--;\n\n    self._input.push({\n      row: row,\n      pkg: pkg\n    });\n\n    next();\n  });\n};\n\nDeps.prototype._flush = function () {\n  var self = this;\n  var files = {};\n\n  self._input.forEach(function (r) {\n    var w = r.row,\n        f = files[w.file || w.id];\n\n    if (f) {\n      f.row.entry = f.row.entry || w.entry;\n      var ex = f.row.expose || w.expose;\n      f.row.expose = ex;\n\n      if (ex && f.row.file === f.row.id && w.file !== w.id) {\n        f.row.id = w.id;\n      }\n    } else files[w.file || w.id] = r;\n  });\n\n  Object.keys(files).forEach(function (key) {\n    var r = files[key];\n    var pkg = r.pkg || {};\n    var dir = r.row.file ? path.dirname(r.row.file) : self.basedir;\n    if (!pkg.__dirname) pkg.__dirname = dir;\n    self.walk(r.row, xtend(self.top, {\n      filename: path.join(dir, '_fake.js')\n    }));\n  });\n  if (this.pending === 0) this.push(null);\n  this._ended = true;\n};\n\nDeps.prototype.resolve = function (id, parent, cb) {\n  var self = this;\n  var opts = self.options;\n\n  if (xhas(self.cache, parent.id, 'deps', id) && self.cache[parent.id].deps[id]) {\n    var file = self.cache[parent.id].deps[id];\n    var pkg = self.pkgCache[file];\n    if (pkg) return cb(null, file, pkg);\n    return self.lookupPackage(file, function (err, pkg) {\n      cb(null, file, pkg);\n    });\n  }\n\n  parent.packageFilter = function (p, x) {\n    var pkgdir = path.dirname(x);\n    if (opts.packageFilter) p = opts.packageFilter(p, x);\n    p.__dirname = pkgdir;\n    return p;\n  }; // have `resolve` do all the package.json lookups,\n  // see discussion in https://github.com/browserify/browser-resolve/issues/93#issuecomment-667837808\n\n\n  parent.package = undefined;\n  if (opts.extensions) parent.extensions = opts.extensions;\n  if (opts.modules) parent.modules = opts.modules;\n  self.resolver(id, parent, function onresolve(err, file, pkg, fakePath) {\n    if (err) return cb(err);\n    if (!file) return cb(new Error('module not found: \"' + id + '\" from file ' + parent.filename));\n\n    if (!pkg || !pkg.__dirname) {\n      self.lookupPackage(file, function (err, p) {\n        if (err) return cb(err);\n        if (!p) p = {};\n        if (!p.__dirname) p.__dirname = path.dirname(file);\n        self.pkgCache[file] = p;\n        onresolve(err, file, opts.packageFilter ? opts.packageFilter(p, p.__dirname) : p, fakePath);\n      });\n    } else cb(err, file, pkg, fakePath);\n  });\n};\n\nDeps.prototype.readFile = function (file, id, pkg) {\n  var self = this;\n\n  if (xhas(this.fileCache, file)) {\n    return toStream(this.fileCache[file]);\n  }\n\n  var rs = fs.createReadStream(file, {\n    encoding: 'utf8'\n  });\n  return rs;\n};\n\nDeps.prototype.getTransforms = function (file, pkg, opts) {\n  if (!opts) opts = {};\n  var self = this;\n  var isTopLevel;\n  if (opts.builtin || opts.inNodeModules) isTopLevel = false;else isTopLevel = this._isTopLevel(file);\n  var transforms = [].concat(isTopLevel ? this.transforms : []).concat(getTransforms(pkg, {\n    globalTransform: this.globalTransforms,\n    transformKey: this.options.transformKey\n  }));\n  if (transforms.length === 0) return through();\n  var pending = transforms.length;\n  var streams = [];\n  var input = through();\n  var output = through();\n  var dup = duplexer(input, output);\n\n  for (var i = 0; i < transforms.length; i++) (function (i) {\n    makeTransform(transforms[i], function (err, trs) {\n      if (err) {\n        return dup.emit('error', err);\n      }\n\n      streams[i] = trs;\n      if (--pending === 0) done();\n    });\n  })(i);\n\n  return dup;\n\n  function done() {\n    var middle = combine.apply(null, streams);\n    middle.on('error', function (err) {\n      err.message += ' while parsing file: ' + file;\n      if (!err.filename) err.filename = file;\n      dup.emit('error', err);\n    });\n    input.pipe(middle).pipe(output);\n  }\n\n  function makeTransform(tr, cb) {\n    var trOpts = {};\n\n    if (Array.isArray(tr)) {\n      trOpts = tr[1] || {};\n      tr = tr[0];\n    }\n\n    trOpts._flags = trOpts.hasOwnProperty('_flags') ? trOpts._flags : self.options;\n\n    if (typeof tr === 'function') {\n      var t = tr(file, trOpts); // allow transforms to `stream.emit('dep', path)` to add dependencies for this file\n\n      t.on('dep', function (dep) {\n        if (!self._transformDeps[file]) self._transformDeps[file] = [];\n\n        self._transformDeps[file].push(dep);\n      });\n      self.emit('transform', t, file);\n      nextTick(cb, null, wrapTransform(t));\n    } else {\n      loadTransform(tr, trOpts, function (err, trs) {\n        if (err) return cb(err);\n        cb(null, wrapTransform(trs));\n      });\n    }\n  }\n\n  function loadTransform(id, trOpts, cb) {\n    var params = {\n      basedir: path.dirname(file),\n      preserveSymlinks: false\n    };\n    nodeResolve(id, params, function nr(err, res, again) {\n      if (err && again) return cb && cb(err);\n\n      if (err) {\n        params.basedir = pkg.__dirname;\n        return nodeResolve(id, params, function (e, r) {\n          nr(e, r, true);\n        });\n      }\n\n      if (!res) return cb(new Error('cannot find transform module ' + tr + ' while transforming ' + file));\n\n      var r = require(res);\n\n      if (typeof r !== 'function') {\n        return cb(new Error('Unexpected ' + typeof r + ' exported by the ' + JSON.stringify(res) + ' package. ' + 'Expected a transform function.'));\n      }\n\n      var trs = r(file, trOpts); // allow transforms to `stream.emit('dep', path)` to add dependencies for this file\n\n      trs.on('dep', function (dep) {\n        if (!self._transformDeps[file]) self._transformDeps[file] = [];\n\n        self._transformDeps[file].push(dep);\n      });\n      self.emit('transform', trs, file);\n      cb(null, trs);\n    });\n  }\n};\n\nDeps.prototype.walk = function (id, parent, cb) {\n  var self = this;\n  var opts = self.options;\n  this.pending++;\n  var rec = {};\n  var input;\n\n  if (typeof id === 'object') {\n    rec = xtend(id);\n    if (rec.entry === false) delete rec.entry;\n    id = rec.file || rec.id;\n    input = true;\n    this.inputPending++;\n  }\n\n  self.resolve(id, parent, function (err, file, pkg, fakePath) {\n    // this is checked early because parent.modules is also modified\n    // by this function.\n    var builtin = has(parent.modules, id);\n\n    if (rec.expose) {\n      // Set options.expose to make the resolved pathname available to the\n      // caller. They may or may not have requested it, but it's harmless\n      // to set this if they didn't.\n      self.options.expose[rec.expose] = self.options.modules[rec.expose] = file;\n    }\n\n    if (pkg && !self._emittedPkg[pkg.__dirname]) {\n      self._emittedPkg[pkg.__dirname] = true;\n      self.emit('package', pkg);\n    }\n\n    if (opts.postFilter && !opts.postFilter(id, file, pkg)) {\n      if (--self.pending === 0) self.push(null);\n      if (input) --self.inputPending;\n      return cb && cb(null, undefined);\n    }\n\n    if (err && rec.source) {\n      file = rec.file;\n      var ts = self.getTransforms(file, pkg);\n      ts.on('error', function (err) {\n        self.emit('error', err);\n      });\n      ts.pipe(concat(function (body) {\n        rec.source = body.toString('utf8');\n        fromSource(file, rec.source, pkg);\n      }));\n      return ts.end(rec.source);\n    }\n\n    if (err && self.options.ignoreMissing) {\n      if (--self.pending === 0) self.push(null);\n      if (input) --self.inputPending;\n      self.emit('missing', id, parent);\n      return cb && cb(null, undefined);\n    }\n\n    if (err) {\n      var message = 'Can\\'t walk dependency graph: ' + err.message;\n      message += '\\n    required by ' + parent.filename;\n      err.message = message;\n      return self.emit('error', err);\n    }\n\n    if (self.visited[file]) {\n      if (--self.pending === 0) self.push(null);\n      if (input) --self.inputPending;\n      return cb && cb(null, file);\n    }\n\n    self.visited[file] = true;\n\n    if (rec.source) {\n      var ts = self.getTransforms(file, pkg);\n      ts.on('error', function (err) {\n        self.emit('error', err);\n      });\n      ts.pipe(concat(function (body) {\n        rec.source = body.toString('utf8');\n        fromSource(file, rec.source, pkg);\n      }));\n      return ts.end(rec.source);\n    }\n\n    var c = self.cache && self.cache[file];\n    if (c) return fromDeps(file, c.source, c.package, fakePath, Object.keys(c.deps));\n    self.persistentCache(file, id, pkg, persistentCacheFallback, function (err, c) {\n      self.emit('file', file, id);\n\n      if (err) {\n        self.emit('error', err);\n        return;\n      }\n\n      fromDeps(file, c.source, c.package, fakePath, Object.keys(c.deps));\n    });\n\n    function persistentCacheFallback(dataAsString, cb) {\n      var stream = dataAsString ? toStream(dataAsString) : self.readFile(file, id, pkg).on('error', cb);\n      stream.pipe(self.getTransforms(fakePath || file, pkg, {\n        builtin: builtin,\n        inNodeModules: parent.inNodeModules\n      })).on('error', cb).pipe(concat(function (body) {\n        var src = body.toString('utf8');\n\n        try {\n          var deps = getDeps(file, src);\n        } catch (err) {\n          cb(err);\n        }\n\n        if (deps) {\n          cb(null, {\n            source: src,\n            package: pkg,\n            deps: deps.reduce(function (deps, dep) {\n              deps[dep] = true;\n              return deps;\n            }, {})\n          });\n        }\n      }));\n    }\n  });\n\n  function getDeps(file, src) {\n    var deps = rec.noparse ? [] : self.parseDeps(file, src); // dependencies emitted by transforms\n\n    if (self._transformDeps[file]) deps = deps.concat(self._transformDeps[file]);\n    return deps;\n  }\n\n  function fromSource(file, src, pkg, fakePath) {\n    var deps = getDeps(file, src);\n    if (deps) fromDeps(file, src, pkg, fakePath, deps);\n  }\n\n  function fromDeps(file, src, pkg, fakePath, deps) {\n    var p = deps.length;\n    var resolved = {};\n    if (input) --self.inputPending;\n\n    (function resolve() {\n      if (self.inputPending > 0) return setTimeout(resolve);\n      deps.forEach(function (id) {\n        if (opts.filter && !opts.filter(id)) {\n          resolved[id] = false;\n          if (--p === 0) done();\n          return;\n        }\n\n        var isTopLevel = self._isTopLevel(fakePath || file);\n\n        var current = {\n          id: file,\n          filename: file,\n          basedir: path.dirname(file),\n          paths: self.paths,\n          package: pkg,\n          inNodeModules: parent.inNodeModules || !isTopLevel\n        };\n        self.walk(id, current, function (err, r) {\n          resolved[id] = r;\n          if (--p === 0) done();\n        });\n      });\n      if (deps.length === 0) done();\n    })();\n\n    function done() {\n      if (!rec.id) rec.id = file;\n      if (!rec.source) rec.source = src;\n      if (!rec.deps) rec.deps = resolved;\n      if (!rec.file) rec.file = file;\n\n      if (self.entries.indexOf(file) >= 0) {\n        rec.entry = true;\n      }\n\n      self.push(rec);\n      if (cb) cb(null, file);\n      if (--self.pending === 0) self.push(null);\n    }\n  }\n};\n\nDeps.prototype.parseDeps = function (file, src, cb) {\n  var self = this;\n  if (this.options.noParse === true) return [];\n  if (/\\.json$/.test(file)) return [];\n\n  if (Array.isArray(this.options.noParse) && this.options.noParse.indexOf(file) >= 0) {\n    return [];\n  }\n\n  try {\n    var deps = self.detective(src);\n  } catch (ex) {\n    var message = ex && ex.message ? ex.message : ex;\n    throw new Error('Parsing file ' + file + ': ' + message);\n  }\n\n  return deps;\n};\n\nDeps.prototype.lookupPackage = function (file, cb) {\n  var self = this;\n  var cached = this.pkgCache[file];\n  if (cached) return nextTick(cb, null, cached);\n  if (cached === false) return nextTick(cb, null, undefined);\n  var dirs = parents(file ? path.dirname(file) : self.basedir);\n\n  (function next() {\n    if (dirs.length === 0) {\n      self.pkgCache[file] = false;\n      return cb(null, undefined);\n    }\n\n    var dir = dirs.shift();\n\n    if (dir.split(/[\\\\\\/]/).slice(-1)[0] === 'node_modules') {\n      return cb(null, undefined);\n    }\n\n    var pkgfile = path.join(dir, 'package.json');\n    var cached = self.pkgCache[pkgfile];\n    if (cached) return nextTick(cb, null, cached);else if (cached === false) return next();\n    var pcached = self.pkgFileCachePending[pkgfile];\n    if (pcached) return pcached.push(onpkg);\n    pcached = self.pkgFileCachePending[pkgfile] = [];\n    fs.readFile(pkgfile, function (err, src) {\n      if (err) return onpkg();\n\n      try {\n        var pkg = JSON.parse(src);\n      } catch (err) {\n        return onpkg(new Error([err + ' while parsing json file ' + pkgfile].join('')));\n      }\n\n      pkg.__dirname = dir;\n      self.pkgCache[pkgfile] = pkg;\n      self.pkgCache[file] = pkg;\n      onpkg(null, pkg);\n    });\n\n    function onpkg(err, pkg) {\n      if (self.pkgFileCachePending[pkgfile]) {\n        var fns = self.pkgFileCachePending[pkgfile];\n        delete self.pkgFileCachePending[pkgfile];\n        fns.forEach(function (f) {\n          f(err, pkg);\n        });\n      }\n\n      if (err) cb(err);else if (pkg && typeof pkg === 'object') cb(null, pkg);else {\n        self.pkgCache[pkgfile] = false;\n        next();\n      }\n    }\n  })();\n};\n\nfunction getTransforms(pkg, opts) {\n  var trx = [];\n\n  if (opts.transformKey) {\n    var n = pkg;\n    var keys = opts.transformKey;\n\n    for (var i = 0; i < keys.length; i++) {\n      if (n && typeof n === 'object') n = n[keys[i]];else break;\n    }\n\n    if (i === keys.length) {\n      trx = [].concat(n).filter(Boolean);\n    }\n  }\n\n  return trx.concat(opts.globalTransform || []);\n}\n\nfunction nextTick(cb) {\n  var args = [].slice.call(arguments, 1);\n  process.nextTick(function () {\n    cb.apply(null, args);\n  });\n}\n\nfunction xhas(obj) {\n  if (!obj) return false;\n\n  for (var i = 1; i < arguments.length; i++) {\n    var key = arguments[i];\n    if (!has(obj, key)) return false;\n    obj = obj[key];\n  }\n\n  return true;\n}\n\nfunction toStream(dataAsString) {\n  var tr = through();\n  tr.push(dataAsString);\n  tr.push(null);\n  return tr;\n}\n\nfunction has(obj, key) {\n  return obj && Object.prototype.hasOwnProperty.call(obj, key);\n}\n\nfunction wrapTransform(tr) {\n  if (typeof tr.read === 'function') return tr;\n  var input = through(),\n      output = through();\n  input.pipe(tr).pipe(output);\n  var wrapper = duplexer(input, output);\n  tr.on('error', function (err) {\n    wrapper.emit('error', err);\n  });\n  return wrapper;\n}","map":{"version":3,"sources":["C:/Users/shashidhar/OneDrive/Desktop/assignment8ui/node_modules/module-deps/index.js"],"names":["fs","require","path","relativePath","browserResolve","nodeResolve","detective","through","concat","parents","combine","duplexer","xtend","defined","inherits","Transform","module","exports","Deps","opts","self","call","objectMode","basedir","process","cwd","persistentCache","file","id","pkg","fallback","cb","nextTick","cache","fileCache","pkgCache","packageCache","pkgFileCache","pkgFileCachePending","_emittedPkg","_transformDeps","visited","walking","entries","_input","paths","env","NODE_PATH","delimiter","platform","split","filter","Boolean","map","p","resolve","transforms","transform","globalTransforms","globalTransform","resolver","detect","options","modules","expose","pending","inputPending","topfile","join","top","filename","prototype","_isTopLevel","isTopLevel","some","main","m","dirname","indexOf","_transform","row","enc","next","global","push","entry","lookupPackage","err","ignoreMissing","emit","_flush","files","forEach","r","w","f","ex","Object","keys","key","dir","__dirname","walk","_ended","parent","xhas","deps","packageFilter","x","pkgdir","package","undefined","extensions","onresolve","fakePath","Error","readFile","toStream","rs","createReadStream","encoding","getTransforms","builtin","inNodeModules","transformKey","length","streams","input","output","dup","i","makeTransform","trs","done","middle","apply","on","message","pipe","tr","trOpts","Array","isArray","_flags","hasOwnProperty","t","dep","wrapTransform","loadTransform","params","preserveSymlinks","nr","res","again","e","JSON","stringify","rec","has","postFilter","source","ts","body","toString","fromSource","end","c","fromDeps","persistentCacheFallback","dataAsString","stream","src","getDeps","reduce","noparse","parseDeps","resolved","setTimeout","current","noParse","test","cached","dirs","shift","slice","pkgfile","pcached","onpkg","parse","fns","trx","n","args","arguments","obj","read","wrapper"],"mappings":"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","sourcesContent":["var fs = require('fs');\nvar path = require('path');\nvar relativePath = require('cached-path-relative');\n\nvar browserResolve = require('browser-resolve');\nvar nodeResolve = require('resolve');\nvar detective = require('detective');\nvar through = require('through2');\nvar concat = require('concat-stream');\nvar parents = require('parents');\nvar combine = require('stream-combiner2');\nvar duplexer = require('duplexer2');\nvar xtend = require('xtend');\nvar defined = require('defined');\n\nvar inherits = require('inherits');\nvar Transform = require('readable-stream').Transform;\n\nmodule.exports = Deps;\ninherits(Deps, Transform);\n\nfunction Deps (opts) {\n    var self = this;\n    if (!(this instanceof Deps)) return new Deps(opts);\n    Transform.call(this, { objectMode: true });\n    \n    if (!opts) opts = {};\n    \n    this.basedir = opts.basedir || process.cwd();\n    this.persistentCache = opts.persistentCache || function (file, id, pkg, fallback, cb) {\n        process.nextTick(function () {\n            fallback(null, cb);\n        });\n    };\n    this.cache = opts.cache;\n    this.fileCache = opts.fileCache;\n    this.pkgCache = opts.packageCache || {};\n    this.pkgFileCache = {};\n    this.pkgFileCachePending = {};\n    this._emittedPkg = {};\n    this._transformDeps = {};\n    this.visited = {};\n    this.walking = {};\n    this.entries = [];\n    this._input = [];\n    \n    this.paths = opts.paths || process.env.NODE_PATH || '';\n    if (typeof this.paths === 'string') {\n        var delimiter = path.delimiter || (process.platform === 'win32' ? ';' : ':');\n        this.paths = this.paths.split(delimiter);\n    }\n    this.paths = this.paths\n        .filter(Boolean)\n        .map(function (p) {\n            return path.resolve(self.basedir, p);\n        });\n    \n    this.transforms = [].concat(opts.transform).filter(Boolean);\n    this.globalTransforms = [].concat(opts.globalTransform).filter(Boolean);\n    this.resolver = opts.resolve || browserResolve;\n    this.detective = opts.detect || detective;\n    this.options = xtend(opts);\n    if (!this.options.modules) this.options.modules = {};\n\n    // If the caller passes options.expose, store resolved pathnames for exposed\n    // modules in it. If not, set it anyway so it's defined later.\n    if (!this.options.expose) this.options.expose = {};\n    this.pending = 0;\n    this.inputPending = 0;\n    \n    var topfile = path.join(this.basedir, '__fake.js');\n    this.top = {\n        id: topfile,\n        filename: topfile,\n        paths: this.paths,\n        basedir: this.basedir\n    };\n}\n\nDeps.prototype._isTopLevel = function (file) {\n    var isTopLevel = this.entries.some(function (main) {\n        var m = relativePath(path.dirname(main), file);\n        return m.split(/[\\\\\\/]/).indexOf('node_modules') < 0;\n    });\n    if (!isTopLevel) {\n        var m = relativePath(this.basedir, file);\n        isTopLevel = m.split(/[\\\\\\/]/).indexOf('node_modules') < 0;\n    }\n    return isTopLevel;\n};\n\nDeps.prototype._transform = function (row, enc, next) {\n    var self = this;\n    if (typeof row === 'string') {\n        row = { file: row };\n    }\n    if (row.transform && row.global) {\n        this.globalTransforms.push([ row.transform, row.options ]);\n        return next();\n    }\n    else if (row.transform) {\n        this.transforms.push([ row.transform, row.options ]);\n        return next();\n    }\n    \n    self.pending ++;\n    var basedir = defined(row.basedir, self.basedir);\n    \n    if (row.entry !== false) {\n        self.entries.push(path.resolve(basedir, row.file || row.id));\n    }\n    \n    self.lookupPackage(row.file, function (err, pkg) {\n        if (err && self.options.ignoreMissing) {\n            self.emit('missing', row.file, self.top);\n            self.pending --;\n            return next();\n        }\n        if (err) return self.emit('error', err)\n        self.pending --;\n        self._input.push({ row: row, pkg: pkg });\n        next();\n    });\n};\n\nDeps.prototype._flush = function () {\n    var self = this;\n    var files = {};\n    self._input.forEach(function (r) {\n        var w = r.row, f = files[w.file || w.id];\n        if (f) {\n            f.row.entry = f.row.entry || w.entry;\n            var ex = f.row.expose || w.expose;\n            f.row.expose = ex;\n            if (ex && f.row.file === f.row.id && w.file !== w.id) {\n                f.row.id = w.id;\n            }\n        }\n        else files[w.file || w.id] = r;\n    });\n    \n    Object.keys(files).forEach(function (key) {\n        var r = files[key];\n        var pkg = r.pkg || {};\n        var dir = r.row.file ? path.dirname(r.row.file) : self.basedir;\n        if (!pkg.__dirname) pkg.__dirname = dir;\n        self.walk(r.row, xtend(self.top, {\n            filename: path.join(dir, '_fake.js')\n        }));\n    });\n    if (this.pending === 0) this.push(null);\n    this._ended = true;\n};\n\nDeps.prototype.resolve = function (id, parent, cb) {\n    var self = this;\n    var opts = self.options;\n    \n    if (xhas(self.cache, parent.id, 'deps', id)\n    && self.cache[parent.id].deps[id]) {\n        var file = self.cache[parent.id].deps[id];\n        var pkg = self.pkgCache[file];\n        if (pkg) return cb(null, file, pkg);\n        return self.lookupPackage(file, function (err, pkg) {\n            cb(null, file, pkg);\n        });\n    }\n    \n    parent.packageFilter = function (p, x) {\n        var pkgdir = path.dirname(x);\n        if (opts.packageFilter) p = opts.packageFilter(p, x);\n        p.__dirname = pkgdir;\n\n        return p;\n    };\n\n    // have `resolve` do all the package.json lookups,\n    // see discussion in https://github.com/browserify/browser-resolve/issues/93#issuecomment-667837808\n    parent.package = undefined;\n    \n    if (opts.extensions) parent.extensions = opts.extensions;\n    if (opts.modules) parent.modules = opts.modules;\n    \n    self.resolver(id, parent, function onresolve (err, file, pkg, fakePath) {\n        if (err) return cb(err);\n        if (!file) return cb(new Error(\n            'module not found: \"' + id + '\" from file '\n            + parent.filename\n        ));\n        \n        if (!pkg || !pkg.__dirname) {\n            self.lookupPackage(file, function (err, p) {\n                if (err) return cb(err);\n                if (!p) p = {};\n                if (!p.__dirname) p.__dirname = path.dirname(file);\n                self.pkgCache[file] = p;\n                onresolve(err, file, opts.packageFilter\n                    ? opts.packageFilter(p, p.__dirname) : p,\n                    fakePath\n                );\n            });\n        }\n        else cb(err, file, pkg, fakePath);\n    });\n};\n\nDeps.prototype.readFile = function (file, id, pkg) {\n    var self = this;\n    if (xhas(this.fileCache, file)) {\n        return toStream(this.fileCache[file]);\n    }\n    var rs = fs.createReadStream(file, {\n        encoding: 'utf8'\n    });\n    return rs;\n};\n\nDeps.prototype.getTransforms = function (file, pkg, opts) {\n    if (!opts) opts = {};\n    var self = this;\n    \n    var isTopLevel;\n    if (opts.builtin || opts.inNodeModules) isTopLevel = false;\n    else isTopLevel = this._isTopLevel(file);\n    \n    var transforms = [].concat(isTopLevel ? this.transforms : [])\n        .concat(getTransforms(pkg, {\n            globalTransform: this.globalTransforms,\n            transformKey: this.options.transformKey\n        }))\n    ;\n    if (transforms.length === 0) return through();\n    \n    var pending = transforms.length;\n    var streams = [];\n    var input = through();\n    var output = through();\n    var dup = duplexer(input, output);\n    \n    for (var i = 0; i < transforms.length; i++) (function (i) {\n        makeTransform(transforms[i], function (err, trs) {\n            if (err) {\n                return dup.emit('error', err);\n            }\n            streams[i] = trs;\n            if (-- pending === 0) done();\n        });\n    })(i);\n    return dup;\n    \n    function done () {\n        var middle = combine.apply(null, streams);\n        middle.on('error', function (err) {\n            err.message += ' while parsing file: ' + file;\n            if (!err.filename) err.filename = file;\n            dup.emit('error', err);\n        });\n        input.pipe(middle).pipe(output);\n    }\n    \n    function makeTransform (tr, cb) {\n        var trOpts = {};\n        if (Array.isArray(tr)) {\n            trOpts = tr[1] || {};\n            tr = tr[0];\n        }\n        trOpts._flags = trOpts.hasOwnProperty('_flags') ? trOpts._flags : self.options;\n        if (typeof tr === 'function') {\n            var t = tr(file, trOpts);\n            // allow transforms to `stream.emit('dep', path)` to add dependencies for this file\n            t.on('dep', function (dep) {\n                if (!self._transformDeps[file]) self._transformDeps[file] = [];\n                self._transformDeps[file].push(dep);\n            });\n            self.emit('transform', t, file);\n            nextTick(cb, null, wrapTransform(t));\n        }\n        else {\n            loadTransform(tr, trOpts, function (err, trs) {\n                if (err) return cb(err);\n                cb(null, wrapTransform(trs));\n            });\n        }\n    }\n    \n    function loadTransform (id, trOpts, cb) {\n        var params = {\n            basedir: path.dirname(file),\n            preserveSymlinks: false\n        };\n        nodeResolve(id, params, function nr (err, res, again) {\n            if (err && again) return cb && cb(err);\n            \n            if (err) {\n                params.basedir = pkg.__dirname;\n                return nodeResolve(id, params, function (e, r) {\n                    nr(e, r, true);\n                });\n            }\n            \n            if (!res) return cb(new Error(\n                'cannot find transform module ' + tr\n                + ' while transforming ' + file\n            ));\n            \n            var r = require(res);\n            if (typeof r !== 'function') {\n                return cb(new Error(\n                    'Unexpected ' + typeof r + ' exported by the '\n                    + JSON.stringify(res) + ' package. '\n                    + 'Expected a transform function.'\n                ));\n            }\n            \n            var trs = r(file, trOpts);\n            // allow transforms to `stream.emit('dep', path)` to add dependencies for this file\n            trs.on('dep', function (dep) {\n                if (!self._transformDeps[file]) self._transformDeps[file] = [];\n                self._transformDeps[file].push(dep);\n            });\n            self.emit('transform', trs, file);\n            cb(null, trs);\n        });\n    }\n};\n\nDeps.prototype.walk = function (id, parent, cb) {\n    var self = this;\n    var opts = self.options;\n    this.pending ++;\n    \n    var rec = {};\n    var input;\n    if (typeof id === 'object') {\n        rec = xtend(id);\n        if (rec.entry === false) delete rec.entry;\n        id = rec.file || rec.id;\n        input = true;\n        this.inputPending ++;\n    }\n    \n    self.resolve(id, parent, function (err, file, pkg, fakePath) {\n        // this is checked early because parent.modules is also modified\n        // by this function.\n        var builtin = has(parent.modules, id);\n\n        if (rec.expose) {\n            // Set options.expose to make the resolved pathname available to the\n            // caller. They may or may not have requested it, but it's harmless\n            // to set this if they didn't.\n            self.options.expose[rec.expose] =\n                self.options.modules[rec.expose] = file;\n        }\n        if (pkg && !self._emittedPkg[pkg.__dirname]) {\n            self._emittedPkg[pkg.__dirname] = true;\n            self.emit('package', pkg);\n        }\n        \n        if (opts.postFilter && !opts.postFilter(id, file, pkg)) {\n            if (--self.pending === 0) self.push(null);\n            if (input) --self.inputPending;\n            return cb && cb(null, undefined);\n        }\n        if (err && rec.source) {\n            file = rec.file;\n            \n            var ts = self.getTransforms(file, pkg);\n            ts.on('error', function (err) {\n                self.emit('error', err);\n            });\n            ts.pipe(concat(function (body) {\n                rec.source = body.toString('utf8');\n                fromSource(file, rec.source, pkg);\n            }));\n            return ts.end(rec.source);\n        }\n        if (err && self.options.ignoreMissing) {\n            if (--self.pending === 0) self.push(null);\n            if (input) --self.inputPending;\n            self.emit('missing', id, parent);\n            return cb && cb(null, undefined);\n        }\n        if (err) {\n            var message = 'Can\\'t walk dependency graph: ' + err.message;\n            message += '\\n    required by ' + parent.filename;\n            err.message = message;\n            return self.emit('error', err);\n        }\n        if (self.visited[file]) {\n            if (-- self.pending === 0) self.push(null);\n            if (input) --self.inputPending;\n            return cb && cb(null, file);\n        }\n        self.visited[file] = true;\n        \n        if (rec.source) {\n            var ts = self.getTransforms(file, pkg);\n            ts.on('error', function (err) {\n                self.emit('error', err);\n            });\n            ts.pipe(concat(function (body) {\n                rec.source = body.toString('utf8');\n                fromSource(file, rec.source, pkg);\n            }));\n            return ts.end(rec.source);\n        }\n        \n        var c = self.cache && self.cache[file];\n        if (c) return fromDeps(file, c.source, c.package, fakePath, Object.keys(c.deps));\n        \n        self.persistentCache(file, id, pkg, persistentCacheFallback, function (err, c) {\n            self.emit('file', file, id);\n            if (err) {\n                self.emit('error', err);\n                return;\n            }\n            fromDeps(file, c.source, c.package, fakePath, Object.keys(c.deps));\n        });\n\n        function persistentCacheFallback (dataAsString, cb) {\n            var stream = dataAsString ? toStream(dataAsString) : self.readFile(file, id, pkg).on('error', cb);\n            stream\n                .pipe(self.getTransforms(fakePath || file, pkg, {\n                    builtin: builtin,\n                    inNodeModules: parent.inNodeModules\n                }))\n                .on('error', cb)\n                .pipe(concat(function (body) {\n                    var src = body.toString('utf8');\n                    try { var deps = getDeps(file, src); }\n                    catch (err) { cb(err); }\n                    if (deps) {\n                        cb(null, {\n                            source: src,\n                            package: pkg,\n                            deps: deps.reduce(function (deps, dep) {\n                                deps[dep] = true;\n                                return deps;\n                            }, {})\n                        });\n                    }\n                }));\n        }\n    });\n\n    function getDeps (file, src) {\n        var deps = rec.noparse ? [] : self.parseDeps(file, src);\n        // dependencies emitted by transforms\n        if (self._transformDeps[file]) deps = deps.concat(self._transformDeps[file]);\n        return deps;\n    }\n\n    function fromSource (file, src, pkg, fakePath) {\n        var deps = getDeps(file, src);\n        if (deps) fromDeps(file, src, pkg, fakePath, deps);\n    }\n    \n    function fromDeps (file, src, pkg, fakePath, deps) {\n        var p = deps.length;\n        var resolved = {};\n        \n        if (input) --self.inputPending;\n        \n        (function resolve () {\n            if (self.inputPending > 0) return setTimeout(resolve);\n            deps.forEach(function (id) {\n                if (opts.filter && !opts.filter(id)) {\n                    resolved[id] = false;\n                    if (--p === 0) done();\n                    return;\n                }\n                var isTopLevel = self._isTopLevel(fakePath || file);\n                var current = {\n                    id: file,\n                    filename: file,\n                    basedir: path.dirname(file),\n                    paths: self.paths,\n                    package: pkg,\n                    inNodeModules: parent.inNodeModules || !isTopLevel\n                };\n                self.walk(id, current, function (err, r) {\n                    resolved[id] = r;\n                    if (--p === 0) done();\n                });\n            });\n            if (deps.length === 0) done();\n        })();\n        \n        function done () {\n            if (!rec.id) rec.id = file;\n            if (!rec.source) rec.source = src;\n            if (!rec.deps) rec.deps = resolved;\n            if (!rec.file) rec.file = file;\n            \n            if (self.entries.indexOf(file) >= 0) {\n                rec.entry = true;\n            }\n            self.push(rec);\n            \n            if (cb) cb(null, file);\n            if (-- self.pending === 0) self.push(null);\n        }\n    }\n};\n\nDeps.prototype.parseDeps = function (file, src, cb) {\n    var self = this;\n    if (this.options.noParse === true) return [];\n    if (/\\.json$/.test(file)) return [];\n    \n    if (Array.isArray(this.options.noParse)\n    && this.options.noParse.indexOf(file) >= 0) {\n        return [];\n    }\n    \n    try { var deps = self.detective(src) }\n    catch (ex) {\n        var message = ex && ex.message ? ex.message : ex;\n        throw new Error(\n            'Parsing file ' + file + ': ' + message\n        );\n    }\n    return deps;\n};\n\nDeps.prototype.lookupPackage = function (file, cb) {\n    var self = this;\n    \n    var cached = this.pkgCache[file];\n    if (cached) return nextTick(cb, null, cached);\n    if (cached === false) return nextTick(cb, null, undefined);\n    \n    var dirs = parents(file ? path.dirname(file) : self.basedir);\n    \n    (function next () {\n        if (dirs.length === 0) {\n            self.pkgCache[file] = false;\n            return cb(null, undefined);\n        }\n        var dir = dirs.shift();\n        if (dir.split(/[\\\\\\/]/).slice(-1)[0] === 'node_modules') {\n            return cb(null, undefined);\n        }\n        \n        var pkgfile = path.join(dir, 'package.json');\n        \n        var cached = self.pkgCache[pkgfile];\n        if (cached) return nextTick(cb, null, cached);\n        else if (cached === false) return next();\n        \n        var pcached = self.pkgFileCachePending[pkgfile];\n        if (pcached) return pcached.push(onpkg);\n        pcached = self.pkgFileCachePending[pkgfile] = [];\n        \n        fs.readFile(pkgfile, function (err, src) {\n            if (err) return onpkg();\n            try { var pkg = JSON.parse(src) }\n            catch (err) {\n                return onpkg(new Error([\n                    err + ' while parsing json file ' + pkgfile\n                ].join('')));\n            }\n            pkg.__dirname = dir;\n            \n            self.pkgCache[pkgfile] = pkg;\n            self.pkgCache[file] = pkg;\n            onpkg(null, pkg);\n        });\n        \n        function onpkg (err, pkg) {\n            if (self.pkgFileCachePending[pkgfile]) {\n                var fns = self.pkgFileCachePending[pkgfile];\n                delete self.pkgFileCachePending[pkgfile];\n                fns.forEach(function (f) { f(err, pkg) });\n            }\n            if (err) cb(err);\n            else if (pkg && typeof pkg === 'object') cb(null, pkg);\n            else {\n                self.pkgCache[pkgfile] = false;\n                next();\n            }\n        }\n    })();\n};\n \nfunction getTransforms (pkg, opts) {\n    var trx = [];\n    if (opts.transformKey) {\n        var n = pkg;\n        var keys = opts.transformKey;\n        for (var i = 0; i < keys.length; i++) {\n            if (n && typeof n === 'object') n = n[keys[i]];\n            else break;\n        }\n        if (i === keys.length) {\n            trx = [].concat(n).filter(Boolean);\n        }\n    }\n    return trx.concat(opts.globalTransform || []);\n}\n\nfunction nextTick (cb) {\n    var args = [].slice.call(arguments, 1);\n    process.nextTick(function () { cb.apply(null, args) });\n}\n\nfunction xhas (obj) {\n    if (!obj) return false;\n    for (var i = 1; i < arguments.length; i++) {\n        var key = arguments[i];\n        if (!has(obj, key)) return false;\n        obj = obj[key];\n    }\n    return true;\n}\n\nfunction toStream (dataAsString) {\n    var tr = through();\n    tr.push(dataAsString);\n    tr.push(null);\n    return tr;\n}\n\nfunction has (obj, key) {\n    return obj && Object.prototype.hasOwnProperty.call(obj, key);\n}\n\nfunction wrapTransform (tr) {\n    if (typeof tr.read === 'function') return tr;\n    var input = through(), output = through();\n    input.pipe(tr).pipe(output);\n    var wrapper = duplexer(input, output);\n    tr.on('error', function (err) { wrapper.emit('error', err) });\n    return wrapper;\n}\n"]},"metadata":{},"sourceType":"script"}